<!DOCTYPE html>
<html lang="en">
 
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
 
    <link href="style2.css" rel="stylesheet">
    <title>登录客户端</title>

</head>
 
<body onload="randoms()">
    <section>
        <!-- 背景颜色 -->
        <div class="color"></div>
        <div class="color"></div>
        <div class="color"></div>
        <div class="box">
            <!-- 背景圆 -->
            <div class="circle" style="--x:0"></div>
            <div class="circle" style="--x:1"></div>
            <div class="circle" style="--x:2"></div>
            <div class="circle" style="--x:3"></div>
            <div class="circle" style="--x:4"></div>
            <!-- 登录框 -->
            <div class="container">
                <div class="form">
                    <h2>登录</h2>
                    <div>
                        <form id="loginForm" onsubmit="login(); return false;">
							<div>
                            <label for="username">用户名:</label>
                            <input type="text" id="username" required>
							</div>
							<div>
                            <label for="password">密码: </label>
                            <input type="password" id="password" required>
							</div>
                            <button type="submit">登录</button>
                        </form>
                    </div>
                    <div id="loginResult"></div>
                </div>
            </div>
        </div>
    </section>
	<script>
		function login() {
		    const username = document.getElementById('username').value; // 直接获取输入框的值，不应该有额外的引号
		    const password = document.getElementById('password').value;
		
		    fetch(`http://192.168.1.102/user/login`, {
		        method: 'POST',
		        headers: {
		            'Content-Type': 'application/json'
		        },
		        body: JSON.stringify({
		            username: username,
		            password: password
		        })
		    })
		    .then(response => response.json())
		    .then(data => {
		        if (data.success) {
		            document.getElementById('loginResult').innerHTML = '登录成功';
		            window.location.href = 'https://cup-2cq.pages.dev/'; 当前页面跳转
		        } else {
		            document.getElementById('loginResult').innerHTML = '用户名或密码错误';
		        }
		    })
		    .catch(error => {
		        console.error('登录失败:', error);
		        document.getElementById('loginResult').innerHTML = '登录失败，请稍后重试';
		    });
		}
		
	</script>
</body>
 
</html>
